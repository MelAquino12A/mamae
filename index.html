<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>m√£em√£in</title>
  <style>
    /* --- Vari√°veis de cor (tons de lil√°s) --- */
    :root{
      --lilac-1: #F3E8FF;
      --lilac-2: #E9D5FF;
      --lilac-3: #C4B5FD;
      --lilac-4: #A78BFA;
      --lilac-5: #7C3AED;
      --accent: #ffb6c1; /* rosa suave para contraste */
      --glass: rgba(255,255,255,0.12);
      --glass-2: rgba(255,255,255,0.08);
      --radius: 18px;
      --shadow: 0 10px 30px rgba(124,58,237,0.14);
      --font-sans: "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:var(--font-sans);
      background: linear-gradient(180deg,var(--lilac-1) 0%, var(--lilac-2) 40%, var(--lilac-3) 100%);
      color:#2b0836;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:32px;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    .card{
      width:100%;
      max-width:1000px;
      background:linear-gradient(135deg, rgba(255,255,255,0.75), rgba(255,255,255,0.6));
      border-radius:24px;
      box-shadow:var(--shadow);
      overflow:hidden;
      position:relative;
      display:grid;
      grid-template-columns: 1fr 420px;
      gap:0;
    }

    /* painel esquerdo: mensagem */
    .left{
      padding:48px;
      background: repeating-linear-gradient(180deg, transparent 0 40px, rgba(255,255,255,0.02) 40px 80px);
      display:flex;
      flex-direction:column;
      gap:18px;
      align-items:flex-start;
      justify-content:center;
    }

    .greeting{font-size:clamp(26px,4.8vw,40px); font-weight:800; line-height:1.02; color:var(--lilac-5); letter-spacing: -0.02em}
    .sub{font-size:16px; color: #43264a; opacity:0.9}

    .message{
      margin-top:6px;
      background: linear-gradient(90deg, rgba(255,255,255,0.6), rgba(255,255,255,0.3));
      padding:18px;
      border-radius:14px;
      box-shadow: 0 6px 18px rgba(120, 46, 170, 0.07);
      font-size:16px;
    }

    .controls{
      display:flex; gap:12px; margin-top:18px; flex-wrap:wrap;
    }

    .btn{
      border: none;
      padding:12px 18px;
      border-radius:12px;
      cursor:pointer;
      font-weight:700;
      backdrop-filter: blur(6px);
      box-shadow: 0 6px 14px rgba(0,0,0,0.06);
    }

    .btn-primary{
      background:linear-gradient(90deg,var(--lilac-4), var(--lilac-5));
      color:white;
    }
    .btn-ghost{
      background:transparent;
      border:1px solid rgba(124,58,237,0.12);
      color:var(--lilac-5);
    }

    .input{
      padding:10px 12px; border-radius:10px; border:1px solid rgba(0,0,0,0.06); background:var(--glass-2);
    }

    /* painel direito: visual */
    .right{
      padding:28px;
      background: linear-gradient(180deg,var(--lilac-2), rgba(167,139,250,0.06));
      display:flex; flex-direction:column; gap:12px; align-items:center; justify-content:center;
    }

    .photo-frame{
      width:100%; max-width:360px; aspect-ratio: 1/1;
      border-radius:16px; overflow:hidden; position:relative; display:flex; align-items:center; justify-content:center;
      background:linear-gradient(135deg,var(--lilac-3),var(--lilac-4));
      box-shadow: 0 10px 30px rgba(124,58,237,0.12);
      border:6px solid rgba(255,255,255,0.18);
    }

    .photo-frame img{width:100%; height:100%; object-fit:cover; display:block}

    .decoration{
      position:absolute; inset:auto -40px -40px auto; width:180px; height:180px; z-index:0; filter:blur(16px); opacity:0.85;
      background: radial-gradient(circle at 30% 30%, var(--lilac-4), transparent 40%), radial-gradient(circle at 70% 70%, var(--accent), transparent 30%);
      transform: rotate(10deg);
    }

    .footer-note{font-size:13px; color:#4b2b53; opacity:0.9}

    /* balloons */
    .balloons{position:absolute; inset:10px 20px auto auto; width:220px; height:300px; pointer-events:none}
    .balloon{position:absolute; width:48px; height:66px; border-radius:60% 60% 50% 50%; transform-origin:center bottom;}

    /* responsividade */
    @media(max-width:880px){
      .card{grid-template-columns: 1fr;}
      .right{order:-1}
      .balloons{display:none}
    }

    /* small animations */
    .float{animation:float 4s ease-in-out infinite}
    @keyframes float{0%{transform:translateY(0)}50%{transform:translateY(-12px)}100%{transform:translateY(0)}}

    .sparkle{position:absolute; width:8px; height:8px; border-radius:50%; box-shadow:0 0 12px rgba(255,255,255,0.8); opacity:0.9}

    /* confetti canvas covers entire card */
    #confettiCanvas{position:absolute; inset:0; width:100%; height:100%; pointer-events:none}

  </style>
</head>
<body>
  <div class="card" role="main" aria-label="Cart√£o de feliz anivers√°rio para m√£e">

    <canvas id="confettiCanvas" aria-hidden="true"></canvas>

    <div class="left">
      <div style="display:flex; gap:14px; align-items:center">
        <div style="width:56px; height:56px; border-radius:12px; background:linear-gradient(135deg,var(--lilac-5),var(--lilac-4)); display:flex; align-items:center; justify-content:center; color:white; font-weight:900; font-size:18px">E‚ô°</div>
        <div>
          <div class="greeting">Feliz Anivers√°rio, <span id="nomeDisplay">M√£em√£in</span> üéâ</div>
          
        </div>
      </div>

      <div class="message" id="messageText">Seu presente que chegou atrasado, mas est√° feito. Obrigada por tudo que fez e faz por mim! Te amo!</div>

      <div class="controls">
        <input id="nomeInput" class="input" placeholder="Digite o seu nome l√≠ndiu" />
        <button class="btn btn-primary" id="applyName">Aplicar nome</button>

        <button class="btn btn-ghost" id="surpriseBtn">Surpresa üéÅ</button>
        <button class="btn" id="playBtn">‚ñ∂Ô∏è Tocar m√∫sica</button>
        <button class="btn" id="stopBtn">‚è∏Ô∏è Parar m√∫sica</button>
      </div>

      <div style="margin-top:8px">
        <label class="footer-note">Edite a mensagem:</label><br>
        <textarea id="msgEdit" class="input" rows="3" style="width:100%; margin-top:6px">Quem √© Emanuelle? Dona Manu √© uma senhorita muito estressada, por√©m, √© uma mam√£e muito linda e legal dimais, e √© minha mam√£e</textarea>
        <div style="display:flex; gap:8px; margin-top:8px">
          <button class="btn btn-primary" id="applyMsg">Aplicar mensagem</button>
          <button class="btn btn-ghost" id="resetBtn">Resetar</button>
        </div>
      </div>

    </div>

    <div class="right">
      <div class="photo-frame" id="photoFrame">
        <div class="decoration" aria-hidden="true"></div>
        <img id="photoImg" src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='800' height='800'><rect width='100%25' height='100%25' fill='%23F3E8FF'/><text x='50%25' y='50%25' dominant-baseline='middle' text-anchor='middle' font-family='Arial' font-size='36' fill='%237C3AED'>.</text></svg>" alt="Foto da homenageada"/>
      </div>

      <div style="display:flex; gap:8px; margin-top:8px">
        <label class="btn btn-ghost" style="overflow:hidden; padding:8px 12px">
          üì∑ Escolher foto
          <input id="photoInput" type="file" accept="image/*" style="display:none" />
        </label>
        <button class="btn" id="downloadBtn">üì• Baixar cart√£o</button>
      </div>

      <div style="margin-top:8px; text-align:center">
        <div class="footer-note">Toque ‚ñ∂Ô∏è para ouvir uma musiquinha</div>
      </div>
    </div>

    <div class="balloons" aria-hidden="true">
      <div class="balloon float" style="left:12px; bottom:12px; background:linear-gradient(180deg,#ffd6f0,#f3e8ff); transform:rotate(-6deg)"></div>
      <div class="balloon float" style="left:80px; bottom:40px; width:60px; height:82px; background:linear-gradient(180deg,#d6c7ff,#c4b5fd); animation-delay:.4s"></div>
      <div class="balloon float" style="left:146px; bottom:10px; background:linear-gradient(180deg,#eecff3,#fbe8ff); animation-delay:.9s"></div>
    </div>

  </div>

  <script>
    // ---------- utilidades DOM
    const nomeInput = document.getElementById('nomeInput');
    const applyName = document.getElementById('applyName');
    const nomeDisplay = document.getElementById('nomeDisplay');
    const msgEdit = document.getElementById('msgEdit');
    const applyMsg = document.getElementById('applyMsg');
    const messageText = document.getElementById('messageText');
    const resetBtn = document.getElementById('resetBtn');
    const surpriseBtn = document.getElementById('surpriseBtn');
    const confettiCanvas = document.getElementById('confettiCanvas');
    const playBtn = document.getElementById('playBtn');
    const stopBtn = document.getElementById('stopBtn');
    const photoInput = document.getElementById('photoInput');
    const photoImg = document.getElementById('photoImg');
    const downloadBtn = document.getElementById('downloadBtn');

    // aplicar nome
    applyName.addEventListener('click', () => {
      const v = nomeInput.value.trim();
      if(v) nomeDisplay.textContent = v;
    });

    // aplicar mensagem customizada
    applyMsg.addEventListener('click', () => {
      messageText.textContent = msgEdit.value;
    });

    // reset
    resetBtn.addEventListener('click', ()=>{
      nomeDisplay.textContent = 'M√£em√£in';
      msgEdit.value = 'Que seu dia seja repleto de amor, paz e sorrisos. Obrigada por tudo que faz por mim';
      messageText.textContent = msgEdit.value;
      nomeInput.value = '';
    });

    // carregar foto
    photoInput.addEventListener('change', (e)=>{
      const f = e.target.files && e.target.files[0];
      if(!f) return;
      const url = URL.createObjectURL(f);
      photoImg.src = url;
    });

    // gerar confetti simples
    function Confetti(canvas){
      const ctx = canvas.getContext('2d');
      let w=canvas.width = canvas.offsetWidth;
      let h=canvas.height = canvas.offsetHeight;
      const pieces = [];
      const colors = ['#7C3AED','#C4B5FD','#E9D5FF','#FFB6C1','#FDE68A'];
      for(let i=0;i<120;i++){
        pieces.push({
          x: Math.random()*w, y: Math.random()*-h, r: (6+Math.random()*12), c: colors[i%colors.length], vx:(Math.random()-0.5)*1, vy:2+Math.random()*3, rot:Math.random()*Math.PI
        })
      }
      function resize(){ w=canvas.width=canvas.offsetWidth; h=canvas.height=canvas.offsetHeight }
      window.addEventListener('resize', resize);
      let running = false;
      function render(){
        ctx.clearRect(0,0,w,h);
        pieces.forEach(p=>{
          p.x += p.vx; p.y += p.vy; p.rot += 0.05;
          if(p.y>h+50){ p.y = -50; p.x = Math.random()*w }
          ctx.save(); ctx.translate(p.x,p.y); ctx.rotate(p.rot);
          ctx.fillStyle = p.c; ctx.fillRect(-p.r/2,-p.r/2,p.r,p.r*0.7);
          ctx.restore();
        });
        if(running) requestAnimationFrame(render);
      }
      return {
        start:()=>{ running=true; render(); },
        stop:()=>{ running=false; ctx.clearRect(0,0,w,h); }
      }
    }

    const confetti = new Confetti(confettiCanvas);

    // surpresa: confetti + mensagem curta animada
    surpriseBtn.addEventListener('click', ()=>{
      confetti.start();
      setTimeout(()=>confetti.stop(), 6000);
      // pulso visual
      const orig = messageText.style.transform;
      messageText.style.transition = 'transform 0.25s ease';
      messageText.style.transform = 'scale(1.03)';
      setTimeout(()=>{ messageText.style.transform = orig }, 6000);
    });

    // simples m√∫sica via WebAudio (melodia curta)
    let audioCtx;
    let isPlaying=false;
    let oscillatorNodes=[];

    const melody = [440, 494, 523, 659, 587, 523, 494, 440]; // A B C E D C B A (not perfect, but pleasant)
    function playMelody(){
      if(isPlaying) return;
      audioCtx = new (window.AudioContext || window.webkitAudioContext)();
      const now = audioCtx.currentTime;
      melody.forEach((freq,i)=>{
        const o = audioCtx.createOscillator();
        const g = audioCtx.createGain();
        o.type = 'sine';
        o.frequency.setValueAtTime(freq, now + i*0.35);
        g.gain.setValueAtTime(0, now + i*0.35);
        g.gain.linearRampToValueAtTime(0.12, now + i*0.35 + 0.02);
        g.gain.linearRampToValueAtTime(0, now + i*0.35 + 0.32);
        o.connect(g); g.connect(audioCtx.destination);
        o.start(now + i*0.35);
        o.stop(now + i*0.35 + 0.35);
        oscillatorNodes.push(o);
      });
      isPlaying = true;
      setTimeout(()=>{ isPlaying=false; oscillatorNodes=[]; }, melody.length*380);
    }

    playBtn.addEventListener('click', ()=>{
      try{ playMelody(); }
      catch(e){ console.warn(e) }
    });
    stopBtn.addEventListener('click', ()=>{
      if(audioCtx) audioCtx.close(); isPlaying=false; oscillatorNodes=[];
    });

    // baixar o cart√£o como imagem simples (canvas snapshot)
    downloadBtn.addEventListener('click', async ()=>{
      const card = document.querySelector('.card');
      // renderizar via html2canvas-like? sem depend√™ncias, pegamos o elemento via SVG foreignObject trick
      const rect = card.getBoundingClientRect();
      const svg = `<svg xmlns='http://www.w3.org/2000/svg' width='${rect.width}' height='${rect.height}'><foreignObject width='100%' height='100%'>${new XMLSerializer().serializeToString(card)}</foreignObject></svg>`;
      const blob = new Blob([svg], {type:'image/svg+xml;charset=utf-8'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a'); a.href = url; a.download = 'feliz-aniversario-mae.svg'; document.body.appendChild(a); a.click(); a.remove();
      setTimeout(()=>URL.revokeObjectURL(url),2500);
    });

    // pequenas melhorias: impedir que o canvas cubra controles de intera√ß√£o
    document.querySelectorAll('input,button,textarea').forEach(el=>el.addEventListener('click', e=>e.stopPropagation()));

    // acessibilidade: Enter para aplicar nome
    nomeInput.addEventListener('keydown', (e)=>{ if(e.key==='Enter') applyName.click(); });

    // ajustar canvas ao tamanho quando o layout muda
    function resizeCanvas(){ confettiCanvas.width = confettiCanvas.offsetWidth; confettiCanvas.height = confettiCanvas.offsetHeight; }
    window.addEventListener('resize', resizeCanvas); resizeCanvas();

    // insira aqui pequenas mensagens surpresa alternando ao clicar 3x no t√≠tulo
    let clickCount=0; document.querySelector('.greeting').addEventListener('click', ()=>{
      clickCount++; if(clickCount>=3){ clickCount=0; surpriseBtn.click(); }
      setTimeout(()=>clickCount=0,1200);
    });

  </script>
</body>
</html>
